# Chat Component Structure

This directory contains the modular components that make up the AI chat interface.

## Components

*   **`ChatContainer.tsx`**: This is the main orchestrator component. It manages the overall chat state (using the `useChat` hook), handles the main layout structure (header, message list area, input form, and the optional artifacts panel), and passes data and necessary functions down to its child components. It also controls the visibility of the `ArtifactsPanel`.

*   **`ChatHeader.tsx`**: A simple component responsible for displaying the title or header section of the chat interface.

*   **`ChatMessagesList.tsx`**: This component renders the scrollable list of chat messages (both user and assistant messages). It iterates over the messages provided by `ChatContainer` and uses the `ChatMessage` component to render each individual message. It also handles automatically scrolling to the bottom when new messages appear.

*   **`ChatMessage.tsx`**: Responsible for rendering a single message bubble. It handles the styling differences between user and assistant messages, displays the message content, and shows inline loading indicators for any ongoing tool calls specific to that message. It also truncates assistant messages if they contain an artifact that is displayed separately in the `ArtifactsPanel`.

*   **`ChatInputForm.tsx`**: This component manages the user input area at the bottom of the chat. It includes the text input field, the send button, and the "Stop Generating" button that appears while the assistant is responding. It receives handlers from `ChatContainer` to manage input changes and form submission.

*   **`ArtifactsPanel.tsx`**: This component renders the right-hand side panel used to display structured data or "artifacts" generated by AI tool calls (like recipes, lists, etc.). It receives the message list, filters for messages containing tool results, and uses the `ArtifactRenderer` to display each artifact. It features a sticky header with a title and a close button.

*   **`ArtifactRenderer.tsx`**: A dynamic component that acts as a router for displaying different types of artifacts. Based on the `toolName` provided in a tool invocation result, it selects and renders the appropriate specialized artifact component (e.g., `RecipeIngredients`). This makes the system extensible to new artifact types.

## Flow

1.  `ChatContainer` initializes the chat state and renders the main layout (`ChatHeader`, `ChatMessagesList`, `ChatInputForm`).
2.  `ChatMessagesList` receives the messages and renders each one using `ChatMessage`.
3.  When the user types and submits a message via `ChatInputForm`, the state is updated in `ChatContainer` via the `useChat` hook, triggering an API call.
4.  As the assistant responds (potentially involving tool calls), `ChatContainer` updates the message list.
5.  `ChatMessage` displays the assistant's text and any loading indicators for tool calls.
6.  If a tool call completes and generates an artifact result, `ChatContainer` detects this and ensures the `ArtifactsPanel` is visible.
7.  `ArtifactsPanel` filters the messages to find artifact results and passes them to `ArtifactRenderer`.
8.  `ArtifactRenderer` selects the correct component (e.g., `RecipeIngredients`) to display the structured artifact data within the panel.
9.  The user can close the `ArtifactsPanel` using the 'X' button, which updates the visibility state in `ChatContainer`.
